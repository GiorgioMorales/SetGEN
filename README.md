# MSSP: Multi-Set Symbolic Skeleton Prediction for Symbolic Regression

## Description

We present a method that generates univariate symbolic skeletons that aim to describe the functional relation between each variable and the response.
To do this, we introduce a new SR problem called Multi-Set symbolic skeleton prediction (MSSP). It receives multiple 
sets of input--response pairs, where all sets correspond to the same functional form but use different equation constants, 
and outputs a common skeleton expression, as follows:

<p align="center">
  <img src="figs/MSSP_definition.jpg" alt="alt text" width="400">
</p>

We present a novel transformer model called "Multi-Set Transformer" to solve the MSSP problem. The model is pre-trained 
on a large dataset of synthetic symbolic expressions using an entropy-based loss function. The 
identification process of the functional form between each variable and the system's response is viewed as a sequence 
of MSSP problems:

<p align="center">
  <img src="figs/Skeleton.png" alt="alt text" width="500">
</p>

## Usage

This repository contains the following main scripts:

* `Main.py`: Generates multiple symbolic skeletons that explain the functional form between each variable of the system and the system's response.        
* `Comparison.py`: Compares the symbolic skeletons generated by our Multi-Set Transformer and other methods.
* `DemoMSSP.ipynb`: Jupyter notebook demo that demonstrates the symbolic skeleton generation for each system's variable.

Other important scripts:

* `/src/Trainer/TrainMultiSetTRansformer`: Trains the Multi-Set Transformer to solve the MSSP based on a large dataset of pre-generated mathematical expressions.
* `/src/Trainer/TrainNNmodel`: It trains the NN model $\hat{f}$ that acts as a black-box approximation of the system's underlying function $f$ and that is used to generate the artificial multiple sets used for MSSP.

